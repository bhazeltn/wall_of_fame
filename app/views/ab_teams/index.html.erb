<%= render :partial => '/layouts/partials/addrecord', :locals => {addpath: new_ab_team_path } %>
<div class="container">
  <ul class="nav nav-pills">
    <% @years.each_with_index do |y, i| %>
      <%= render :partial => '/layouts/partials/tab', :locals => { y: y.to_s, b: y.to_s, i: i } %> 
    <% end %>
  </ul>
  <div class="tab-content">
    <% @years.each_with_index do |y, i| %>
      <div role="tabpanel" id='y<%= y.to_s %><%= y.to_s %>' <% if i == 0 %> class="tab-pane active" <% else %> class="tab-pane" <% end %>>
        <span>
          <ul class="nav nav-pills">
            <% @teams.each do |t| %>
              <% if @ab_teams.where(team: t, year: y).present? %>
                <%= render :partial => '/layouts/partials/tab', :locals => { y: y.to_s, b: t, i: 1 } %>
              <% end %>
            <% end %>
          </ul>
          <div class="tab-content">
            <% @teams.each do |t| %>
              <% if @ab_teams.where(team: t, year: y).present? %>
                <div role="tabpanel" id='y<%= y.to_s %><%= t.gsub(/\s+/, "") %>' class="tab-pane">
                  <span>
                    <table class="table">
                      <tbody>
                        <% @ab_teams.where(team: t, year: y).in_groups_of(4).each do |grp| %>
                          <tr>
                            <% grp.each do |abt| %>
                              <% if abt.present? %>
                                <td col style="width:25%"><%= abt.skater.name %></td>
                              <% end %>
                            <% end %>
                          </tr>
                        <% end %>
                      </tbody>
                    </table>
                  </span>
                </div>
              <% end %>
            <% end %>
          </div>
        </span>
      </div>
    <% end %>
  </ul>
</div>

