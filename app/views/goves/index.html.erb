<%= render :partial => '/layouts/partials/addrecord', :locals => {addpath: new_gofe_path } %>

<div class = "container">
  <ul class="nav nav-pills nav-fill">
    <% @years.each_with_index do |y, i| %>
      <li class="nav-item" >
        <a href='#y<%= y %>'  aria-controls='y<%= y %>' role="tab" data-toggle="tab" <% if i == 0 %> class="active nav-link red-tab" <% else %> class="nav-link red-tab" <% end %>>
          <h4><%= y %></h4>
        </a>
      </li>
    <% end %>
  </ul>
  <div class="tab-content">
    <% @years.each_with_index do |y, i| %>
      <div role="tabpanel" id='y<%= y %>' <% if i == 0 %> class="tab-pane active" <% else %> class="tab-pane" <% end %>>
        <% @comps.each do |c| %>
          <% if @gofes.where(year: y.to_s, competition_id: c).present? %>
           <div class="card">
              <h5 class="card-header card-danger text-center">
                <%= Competition.find(c).name %>
              </h5>
           </div>
           <div class="card=-text">
              <table class="table table-hover table-sm">
                <thead class="thead-default">
                  <tr>
                    <th col style="width:20%"></th>
                    <th col style="width:25%">Skater(s)</th>
                    <th col style="width:25%">Element</th>
                    <th col style="width:25%">GOE</th>
                    <th col style="width:5%" colspan="3"></th>
                  </tr>
                </thead>
              <% @gofes.where(year: y.to_s, competition: c).each do |g| %>
                <tbody>
                  <tr>
                    <th scope="row"><%= g.level.name %> <%= g.event.name %><br />
                    <%= g.segment.name %></th>
                    <td><%= Skater.find(g.skater1).name %>
                      <% if g.skater2 and g.skater2 != "" %>
                        <br /><%= Skater.find(g.skater2).name %>
                      <% end %>
                    </td>
                    <td><%= g.element %></td>
                    <td>+<%= g.grade %></td>
                    <td>
                      <%= link_to edit_gofe_path(g) do %>
                        <i class="fa fa-pencil" aria-hidden="true"></i>
                      <% end %>
                    </td>
                    <td>
                      <%= link_to g, method: :delete, data: { confirm: 'Are you sure?' } do %>
                        <i class="fa fa-trash" aria-hidden="true"></i>
                      <% end %>
                    </td>
                  </tr>
                </tbody>
              <% end %>  
            </table>
            </div>
          <% end %>
        <% end %> 
      </div>
    <% end %>
  </div>
</div>


